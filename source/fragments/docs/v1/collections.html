<!--
template: docpage
title: Collections - Trio
appendToTarget: true
activeHeaderItem: 2
activeDocIndexItem: 16
-->
<h1>Collections</h1>

<p><mark>introduced in v2.0.0</mark></p>

<p><mark>Important! After upgrading to v2 please delete the <em>root/.cache/stats.json</em> file and the <em>root/trio.manifest.json</em> file before building your projects for the first time.</mark></p>

<p>Collections are groups of pages that are dynamically generated by Trio that you would otherwise have to manually create yourself.</p> 

<p>As an example, let's imagine that you have a team website which includes a page that lists all the team members. Information about each team member is maintained in a file named <em>/source/data/team.json</em>. You would now like to create a detail page for every team member and render those pages when someone clicks on one of the team members in the list.</p>

<p>Without collections, you would have to manually create one fragment for each team member's detail page. If there are only a few team members that wouldn't be too difficult. But suppose there are dozens of team members! Having to manually create and maintain all those fragments would quickly become a burden. <mark>That's where collections come to the rescue; they do all the "heavy lifting" for you. You only need to create one fragment for all those pages and Trio will create a "clone" of that fragment for every member of the team</mark>.</p> 

<h2>Data</h2>

<p>You can use any data source, such as the data exposed by the <a href="/docs/v1/metadata">global metadata</a> </em>  <em>site</em> object, which exposes numerous collections of data that Trio has assembled for your site, or even data hard coded in a collection's <a href="#filter-functions">filter function</a>, to create the pages in your collections.</p>

<h2>Creating Collections</h2>

<h3>Fragments</h3>
<p>To create a collection, add a <em>collection</em> hash to a fragment's front matter and assign the name of a filter function located in the <em>/source/filters</em> folder to the collection's required <em>filterFn</em> property.</p>

<figure>
<pre><code class="html">&lt;!--
template: default
title: Member |
appendToTarget: true
<mark>collection:
    filterFn: member</mark>
--&gt;

&lt;div <mark>data-trio-callback="teamMember"</mark>&gt;
    &lt;h1&gt;&lt;u&gt;Team Member&lt;/u&gt;&lt;/h1&gt;
    &lt;h2 id="name"&gt;Name: &lt;/h2&gt;
    &lt;h2 id="title"&gt;Title: &lt;/h2&gt;
    &lt;p id="bio"&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;a href="/"&gt;Main Page&lt;/a&gt;</code></pre>
<figcaption>Team Member Fragment Used To Generate A Collection Example</figcaption>
</figure>

<p><mark>You can also add custom properties to the collection hash which will be accessible in your collection's filter function.</mark></p>

<p><mark>Note: Collections are always treated as stale and therefore do not need to be marked with alwaysBuild.</mark></p>

<h3 id="filter-functions">Filter Functions</h3>

<p>Filter functions are passed a single parameter which you destructure to access its two properties:</p>
<ul>
    <li><strong>collection</strong>: An alias of the collection hash defined in the fragment.</li>
    <li><strong>site</strong>: The global metadata object.</li>
</ul>
<p>Your collection's filter function should return an array with one item for each page that is to be generated. Each item must include the name of the page, which you assign to to the item's <em>pageName</em> property, and the data for the page, which you can assign to a property that you name and which you can access in your composite's <em>tag-based callback</em> (see Tag-Based Callbacks below).</p>

<figure>
<pre><code class="javascript">module.exports = ({ <mark>site</mark>, <mark>collection</mark> }) =>
    site.dataCatalog.team.map(<mark>item</mark> =>
        ({ <mark>pageName</mark>: `${item.firstName} ${item.lastName}`, <mark>item</mark> }));</code></pre>
<figcaption>/source/filters/member.js Filter Function Example</figcaption>
</figure>

<h3>Tag-Based Callbacks</h3>

<p>In tag-based callbacks for collection pages, the <em>asset.collection</em> property exposes the follow properties:</p>
<ul>
    <li><strong>[data-property-name]</strong>: The data associated with this collection item.</li>
    <li><strong>pageName</strong>: The name of this page associated with this collection item.</li>
    <li><strong>index</strong>: The zero-based index of this collection item.</li>
    <li><strong>totalItems</strong>: The total number of collection items.</li>
</ul>

<figure>
<pre><code class="javascript">module.exports = ({ $tag, $page, <mark>asset</mark> }) => {
    const item = <mark>asset.collection</mark>.item;
    $page("title").append(` ${item.firstName} ${item.lastName}`);
    $tag.find("#page-title").append(` #${<mark>asset.collection</mark>.index + 1}`);
    $tag.find("#name").append(`${item.firstName} ${item.lastName}`);
    $tag.find("#title").append(asset.collection.item.title);
    $tag.find("#bio").append(asset.collection.item.bio);</code></pre>
<figcaption>/source/callbacks/teamMember.js Tag-Based Callback Function Example</figcaption>
</figure>

<h3>Demo</h3>

<p>On <a target="_blank" href="https://github.com/4awpawz/team-members-colloection">Github</a> is small sample project that demonstrates the use of collections. Please feel free to copy the project, build it, run it and examine its code.</p>

<h2>See Also</h2>

<ul>
    <li><a data-trio-link href="/docs/v1/metadata">Metadata</a></li>
    <li><a data-trio-link href="/docs/v1/fragment">Fragment</a></li>
    <li><a data-trio-link href="/docs/v1/tagbasedcallbacks">Tag-Based Callbacks</a></li>
</ul>
